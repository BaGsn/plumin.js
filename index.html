<!doctype html>
<html class="no-js">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<title>Plumin.js | Create and Manipulate fonts like there's no tomorrow.</title>
		<meta name="description" content="">
		<!-- it's an app, disable zooming on mobile devices -->
		<meta name="viewport" content="target-densitydpi=device-dpi, initial-scale=1.0, user-scalable=no" />
		<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

		<link rel="stylesheet" href="bower_components/knacss/css/knacss.css">
		<link rel="stylesheet" href="bower_components/codemirror/lib/codemirror.css">
		<style>
			html,
			body,
			body > .row > .col {
				height: 100%;
			}

			h1 {
				height: 100px;
				margin: 0;
			}

			body > .row {
				height: calc( 100% - 100px );
			}

			textarea.editor,
			textarea.result {
				width: 100%;
				/* Doesn't work in Chrome :-/
				height: calc( 100% - 100px ); */
				height: 400px;

				margin: 0;
			}

			textarea.editor,
			.CodeMirror {
				font-size: 20px;
			}

			textarea.result {
				padding: 20px;

				border: 0;
				border-radius: 0;

				font-family: 'Demo', sans-serif;
				font-size: 50px;

				resize: none;
			}

			.btn {
				border: 1px solid #CCC;
				border-radius: 3px;

				margin-top: 10px;
				padding: 5px 10px;

				font-size: 25px;
				text-decoration: none;
			}
		</style>

	</head>
	<body>
		<!--[if lt IE 10]>
			<p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
		<![endif]-->

		<h1 class="pam">
			<img src="plumin.png" alt="Plumin.js" style="height: 50px;">
			<span class="h2" style="vertical-align: -12px">
			&nbsp;–&nbsp;&nbsp;create and manipulate fonts like no one's watching.
			</span>
		</h1>

		<div class="row">
			<div class="col w50 plm">
				<textarea id="editor" class="editor">
var font = new plumin.Font({
		familyName: 'Demo'
	}),

	// glyphs
	A = new plumin.Glyph({
		name: 'A',
		advanceWidth: 512
	}),
	B = new plumin.Glyph({
		name: 'B',
		advanceWidth: 512
	}),
	C = new plumin.Glyph({
		name: 'C',
		advanceWidth: 512
	}),

	// contours
	ctA = new plumin.Contour({ closed: true }),
	ctB = new plumin.Contour({ closed: true }),
	ctC = new plumin.Contour({ closed: true });

ctA.addNodes([
	new plumin.Node({ point: [50, 0] }),
	new plumin.Node({ point: [256, 800] }),
	new plumin.Node({ point: [462, 0] })
]);

ctB.addNodes([
	new plumin.Node({ point: [50, 0] }),
	new plumin.Node({ point: [50, 800] }),
	new plumin.Node({ point: [462, 800] }),
	new plumin.Node({ point: [462, 0] })
]);

ctC.addNodes([
	new plumin.Node({
		point: [50, 400],
		handleIn: [50, 200],
		handleOut: [50, 600]
	}),
	new plumin.Node({
		point: [256, 800],
		handleIn: [56, 800],
		handleOut: [456, 800]
	}),
	new plumin.Node({
		point: [462, 400],
		handleIn: [462, 600],
		handleOut: [462, 200]
	}),
	new plumin.Node({
		point: [256, 0],
		handleIn: [456, 0],
		handleOut: [56, 0]
	})
]);

A.addContour(ctA);
B.addContour(ctB);
C.addContour(ctC);

font.addGlyphs([
		A,
		B,
		C
	])
	.prepareOT()
	.addToFonts();

/*
var center = new plumin.Point(256, 400);
(function onFrame() {
	ctA.rotate(3, center);
	ctB.rotate(-3, center);
	ctC.rotate(3, center);

	font.prepareOT()
		.addToFonts();

	requestAnimationFrame(onFrame);
})();
*/

return font;
				</textarea>

				<div class="mtm txtcenter">
					<a href="#" class="btn" onclick="_run();">▷ Run</a>
				</div>
			</div>
			<div class="col w50">
				<textarea id="result" class="result pal"> A B C </textarea>

				<div class="mtm txtcenter">
					<a href="#" class="btn" onclick="_download();" download="demo.otf">▽ Download</a>
				</div>
			</div>
		</div>

		<canvas id="demo" style="display: none;">

		<script src="bower_components/codemirror/lib/codemirror.js"></script>
		<script src="bower_components/codemirror/mode/javascript/javascript.js"></script>
		<script src="bower_components/codemirror/addon/edit/closebrackets.js"></script>
		<script src="dist/plumin.js"></script>

		<script>
			plumin.paper.setup('demo');

			var cm = CodeMirror.fromTextArea( document.getElementById('editor'), {
				autoCloseBrackets: true
			});
			cm.setSize('100%', document.getElementById('result').offsetHeight );

			function _run() {
				if ( window.request ) {
					cancelAnimationFrame( request );
				}

				/*jslint evil: true */
				window.font = ( new Function( cm.getValue() ) )();
			}

			function _download() {
				window.font
					.prepareOT()
					.download();
			}
		</script>

		<script>
			/* jshint ignore:start */
			// HANDJS shouldn't process the css
			//HANDJS.doNotProcessCSS = true;
			// google analytics
			var _gaq=[['_setAccount','UA-41962243-3'],['_trackPageview']];
			(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
			g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
			s.parentNode.insertBefore(g,s)}(document,'script'));
		</script>
	</body>
</html>
